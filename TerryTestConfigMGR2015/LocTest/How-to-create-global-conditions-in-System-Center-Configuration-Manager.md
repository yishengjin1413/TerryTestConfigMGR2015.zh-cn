---
title: "如何在 System Center Configuration Manager 中创建全局条件"
ms.custom: na
ms.date: 09/02/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: 
  - configmgr-app
ms.tgt_pltfrm: na
ms.topic: article
applies_to: 
  - System Center Configuration Manager (current branch)
ms.assetid: 2d5f871a-19dc-4bd3-a3ad-4230c7a69f1b
caps.latest.revision: 7
caps.handback.revision: 4
author: barlanmsft
translationtype: Human Translation
---
# 如何在 System Center Configuration Manager 中创建全局条件
在 [!INCLUDE[cm6long](../LocTest/includes/cm6long_md.md)] 中，全局条件是表示业务或技术条件的规则，你可以使用这些条件指定向客户端设备提供和部署应用程序的方式。 你可以从 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 控制台的“全局条件”节点中或在创建部署类型向导中创建全局条件。 可以从创建部署类型向导的“要求”页中访问全局条件。  
  
> [!NOTE]  
>  你只能从创建全局条件的站点中编辑全局条件。  
  
 使用以下过程来创建 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 全局条件。  
  
## 提供有关全局条件的基本信息  
 可以使用几种不同类型的全局条件。 不同的选项与不同的全局条件类型相关联。 选择特定全局条件类型时，[!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 会显示适用于你的选择的选项。  
  
#### 提供有关全局条件的基本信息  
  
1.  在 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 控制台中，单击“软件库”。  
  
2.  在“软件库”工作区中，展开“应用程序管理”，单击“全局条件”。  
  
3.  在“主页”选项卡上的“创建”组中，单击“创建全局条件”。  
  
4.  在“创建全局条件”对话框中，为全局条件提供名称和可选描述。  
  
5.  在“设备类型”下拉列表中，选择全局条件是用于“Windows”计算机、“Windows Mobile”设备还是“Nokia”设备。  
  
6.  在“条件类型”下拉列表中选择以下选项之一：  
  
    -   **设置** – 此选项检查客户端设备上是否存在一个或多个项。 例如，可以检查客户端设备上是否存在特定的文件、文件夹或注册表项值。  
  
    -   **表达式** – 此选项允许你配置更复杂的规则以确定在客户端设备上是否满足条件。 例如，你可以确定计算机上的物理内存是否介于 2 GB 和 4 GB 之间，或者确定移动设备是否使用触摸屏输入。  
  
## 配置全局条件的规则  
 取决于你是要配置设置还是表达式，定义全局条件规则的过程会有所有不同。 使用本文中合适的过程为全局条件配置设置或表达式。  
  
#### 配置全局条件设置  
  
1.  在“条件类型”下拉列表中选择“设置”。  
  
2.  在“设置类型”下拉列表中，选择要用作将对其检查要求的条件的项。 可以使用下列设置类型。  
  
    |设置类型|更多信息|  
    |----------|----------|  
    |Active Directory 查询|配置此设置类型的以下项：<br /><br /> <ul><li>**LDAP 前缀** \- 指定 Active Directory 域服务查询的有效 LDAP 前缀以评估客户端计算机上的符合性。 可以使用 **LDAP:\/\/** 或 **GC:\/\/**。</li><li>**可分辨名称\(DN\)** \- 指定 Active Directory 域服务对象的可分辨名称，将评估此对象以了解客户端计算机上的符合性。</li><li>**搜索筛选器** \- 指定可选的 LDAP 筛选器以优化 Active Directory 域服务查询的结果，从而评估客户端计算机上的符合性。</li><li>**搜索作用域** \- 指定 Active Directory 域服务中的搜索作用域：<br /><br /> <ul><li>**基本** \- 仅查询指定的对象。</li><li>**一级** \- 此版本的 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 中不使用此选项。</li><li>**子树** \- 在目录中查询指定的对象及其完整的子树。</li></ul></li><li>**属性** \- 指定将用于评估客户端计算机上的符合性的 Active Directory 域服务对象属性。</li><li>“查询” \- 显示从“LDAP 前缀”、“可分辨名称 \(DN\)”、“搜索筛选器”（如果指定了）和“属性”中的条目中构造的 LDAP 查询。 此查询将用于评估客户端计算机上的符合性。</li></ul>|  
    |程序集|配置此设置类型的以下项：<br /><br /> -   **程序集名称** \- 指定要搜索的程序集对象的名称。 此名称不能与相同类型的任何其他程序集对象的名称相同，并用必须在全局程序集缓存中注册此名称。 程序集名称长度最多可为 256 个字符。 **Note:**  程序集是可在应用程序之间共享的一段代码。 程序集可以具有 .dll 或 .exe 文件扩展名。 全局程序集缓存是客户端计算机上名为 *%systemroot%\\assembly* 的文件夹，其中存储了所有共享程序集。|  
    |文件系统|配置此设置类型的以下项：<br /><br /> -   “类型” – 从下拉列表中，选择是想要搜索“文件”还是“文件夹”。<br />-   **路径** \- 指定客户端计算机上指定文件或文件夹的路径。 你可以在路径中指定系统环境变量和 *%USERPROFILE%* 环境变量。 **Note:**      如果你使用“路径”或“文件或文件夹名称”字段中的环境变量 *%USERPROFILE%*，将搜索客户端计算机上的所有用户配置文件。 这可能导致发现文件或文件夹的多个实例。<br />-   **文件或文件夹名称** \- 指定将搜索的文件或文件夹对象的名称。 你可以在文件或文件夹名称中指定系统环境变量和 *%USERPROFILE%* 环境变量。 还可以在文件名中 使用通配符 \* 和 ?。 **Note:**      如果指定文件或文件夹名称并使用通配符，则可能会产生大量的结果。 这可能会导致客户端计算机上资源使用率高，在将结果报告给 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 时也可能导致高网络流量。<br />-   **包括子文件夹** – 如果也要搜索指定路径下面的任何子文件夹，请启用此选项。<br />-   “此文件或文件夹与 64 位应用程序相关联” \- 选择是否在运行 64 位版本 Windows 的 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 客户端上除了搜索 32 位系统文件位置 \(*%windir%*\\syswow64\) 之外还要搜索 64 位系统文件位置 \(*%windir%*\\system32\)。 **Note:**      如果在同一 64 位计算机上的 64 位和 32 位系统文件位置中存在相同的文件或文件夹，则全局条件将发现多个文件。<br /><br /> “文件系统”设置类型不支持在“路径”字段中指定网络共享的 UNC 路径。|  
    |IIS 元数据库|配置此设置类型的以下项：<br /><br /> -   **元数据库路径** \- 指定 IIS 元数据库的有效路径。<br />-   **属性 ID** \- 指定 IIS 元数据库设置的数值属性。|  
    |注册表项|配置此设置类型的以下项：<br /><br /> -   **配置单元** – 从下拉列表中，选择要在其中进行搜索的注册表配置单元。<br />-   **项** \- 指定要搜索的注册表项名称。 所用的格式应为 *key\\subkey*。<br />-   **此注册表项与 64 位应用程序关联** \- 指定在运行 64 位版本的 Windows 的客户端上除了搜索 32 位注册表项之外是否也应该搜索 64 位注册表项。 **Note:**      如果在同一 64 位计算机上的 64 位和 32 位注册表位置中存在相同的注册表项，则全局条件将发现两个注册表项。|  
    |注册表值|配置此设置类型的以下项：<br /><br /> -   **配置单元** – 从下拉列表中，选择要在其中进行搜索的注册表配置单元。<br />-   **项** \- 指定要搜索的注册表项名称。 所用的格式应为 *key\\subkey*。<br />-   **值** – 指定必须包含在指定注册表项中的值。<br />-   **此注册表项与 64 位应用程序关联** \- 指定在运行 64 位版本的 Windows 的客户端上除了搜索 32 位注册表项之外是否也应该搜索 64 位注册表项。 **Note:**      如果在同一 64 位计算机上的 64 位和 32 位注册表位置中存在相同的注册表项，则全局条件将发现两个注册表项。|  
    |脚本|配置此设置类型的以下项：<br /><br /> -   “发现脚本” – 单击“添加”以输入或浏览到要使用的脚本。 可以使用 Windows PowerShell、VBScript 或 JScript 脚本。<br />-   **使用登录用户凭据运行脚本** – 如果启用此选项，则将使用登录用户凭据在客户端计算机上运行脚本。 **Note:**      脚本返回的值将用于评估全局条件的符合性。 例如，使用 VBScript 时，可以使用命令“WScript.Echo Result”将结果变量值返回给全局条件。     如果你的脚本返回多个值，这些值必须位于同一行，各值之间用分号分隔。 如果每个值位于单独的行，则评估将失败。|  
    |SQL 查询|配置此设置类型的以下项：<br /><br /> -   **SQL Server 实例** – 选择是要在默认实例、所有实例还是指定的数据库实例名称上运行 SQL 查询。 **Note:**      实例名称必须引用 SQL Server 的本地实例。 为了引用群集的 SQL Server 实例，应该使用脚本设置。<br />-   **数据库** \- 指定将对其运行 SQL 查询的 Microsoft SQL Server 数据库的名称。<br />-   **列** \- 指定 Transact\-SQL 语句返回的列名称以用于评估全局条件的符合性。<br />-   **Transact\-SQL 语句** – 指定要用于全局条件的完整 SQL 查询。 也可以单击“打开”以打开现有的 SQL 查询。|  
    |WQL 查询|配置此设置类型的以下项：<br /><br /> -   **命名空间** \- 指定将用于构建 WQL 查询的 WMI 命名空间，将评估该查询以了解客户端计算机上的符合性。 默认值为 Root\\cimv2。<br />-   **类** \- 指定将用于构建 WQL 查询的 WMI 类，将评估该查询以了解客户端计算机上的符合性。<br />-   **属性** \- 指定将用于构建 WQL 查询的 WMI 属性，将评估该查询以了解客户端计算机上的符合性。<br />-   “WQL 查询 WHERE 子句” \- 你可使用“WQL 查询 WHERE 子句”项目来指定应用于客户端计算机上指定命名空间、类和属性的 WHERE 子句。|  
    |XPath 查询|配置此设置类型的以下项：<br /><br /> -   “路径” \- 指定指向将用于评估符合性的客户端计算机上的 XML 文件的路径。[!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 支持在路径名称中使用所有 Windows 系统环境变量和 *%USERPROFILE%* 用户变量。<br />-   **XML 文件名** \- 指定文件名，此文件名包含用于评估客户端计算机上的符合性的 XML 查询。<br />-   **包括子文件夹** – 如果也要搜索指定路径下面的任何子文件夹，请启用此选项。<br />-   “此文件与 64 位应用程序相关联” \- 选择是否在运行 64 位版本 Windows 的 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 客户端上除了搜索 32 位系统文件位置 \(*%windir%*\\syswow64\) 之外还要搜索 64 位系统文件位置 \(*%windir%*\\system32\)。<br />-   **XPath 查询** \- 指定用于评估客户端计算机上的符合性的有效完整 XML 路径语言 \(XPath\) 查询。<br />-   “命名空间” \- 打开“XML 命名空间”对话框来确定要在 XPath 查询期间使用的命名空间和前缀。|  
  
3.  在“数据类型”下拉列表中，选择在用于检查要求之前条件将返回的数据的格式。  
  
    > [!NOTE]  
    >  系统没有为所有设置类型显示“数据类型”下拉列表。  
  
4.  在“设置类型”下拉列表下面配置有关此设置的更多详细信息。 可以配置的项将因你已选择的设置类型而异。  
  
5.  单击“确定”以保存规则并关闭“创建全局条件”对话框。  
  
#### 配置全局条件表达式  
  
1.  在“条件类型”下拉列表中选择“表达式”。  
  
2.  单击“添加子句”以打开“添加子句”对话框。  
  
3.  从“选择类别”下拉列表中选择此表达式是用于设备还是用于用户。 或者，选择“自定义”以使用以前配置的全局条件。  
  
4.  从“选择条件”下拉列表中，选择要用于评估用户或设备是否满足规则要求的条件。 根据所选类别，此列表的内容会有所不同。  
  
5.  从“选择运算符”下拉列表中，选择运算符，此运算符用于将所选条件与指定值进行比较以评估用户或设备是否满足规则要求。 可用运算符将因所选条件而异。  
  
6.  在“值”字段中，指定值，这些值将与所选条件和运算符一起用于评估用户或设备是否满足规则要求。 可用值将因所选条件和所选运算符而异。  
  
7.  单击“确定”以保存表达式并关闭“添加子句”对话框。  
  
8.  向全局条件添加完子句后，单击“确定”以关闭“创建全局条件”对话框并保存全局条件。  
  
## 请参阅  
 [System Center Configuration Manager 中应用程序管理的技术参考](../LocTest/Application-management-technical-reference-for-System-Center-Configuration-Manager.md)