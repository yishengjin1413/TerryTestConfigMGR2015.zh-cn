---
title: "如何为使用 System Center Configuration Manager 客户端管理的 Windows 台式机和服务器计算机创建配置项目"
ms.custom: na
ms.date: 09/02/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: 
  - configmgr-other
ms.tgt_pltfrm: na
ms.topic: article
applies_to: 
  - System Center Configuration Manager (current branch)
ms.assetid: 1eb2fcaf-acac-4388-9b31-6cccafacaabe
caps.latest.revision: 9
caps.handback.revision: 9
---
# 如何为使用 System Center Configuration Manager 客户端管理的 Windows 台式机和服务器计算机创建配置项目
使用 [!INCLUDE[cm6long](../LocTest/includes/cm6long_md.md)]“自定义 Windows 台式机和服务器”配置项目为由 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 客户端管理的 Windows 计算机和服务器管理设置。  
  
## 启动向导并指定常规信息  
 此处插入部分正文。  
  
#### 若要创建自定义 Windows 台式机和服务器配置项目  
  
1.  在 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 控制台中，单击“资产和符合性” 。  
  
2.  在“资产和符合性”  工作区中，展开“符合性设置” ，然后单击“配置项目” 。  
  
3.  在“主页”  选项卡上的“创建”  组中，单击“创建配置项目” 。  
  
4.  在“创建配置项目向导”  的“常规” 页面上，指定配置项目的名称和可选描述。  
  
5.  在“指定要创建的配置项目的类型” 下，选择“Windows 台式机和服务器(自定义)” 。  
  
    > [!TIP]  
    >  如果要提供检查应用程序是否存在的检测方法设置，请选择“此配置文件包含应用程序设置” 。  
  
6.  如果创建并分配类别以帮助在 **控制台中搜索和筛选配置项目，请单击“类别”**[!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 。  
  
##  <a name="BKMK_Step3"></a> 提供检测方法信息  
 使用此过程可为配置项目提供检测方法信息。  
  
> [!NOTE]  
>  仅适用于您选择 **此配置项目包含应用程序设置** 上 **常规** 向导页。  
  
 中的检测方法 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 包含用于检测应用程序是否在计算机上安装的规则。 此检测发生之前针对符合性评估配置项目。 若要检测是否安装了应用程序，则可以检测到该应用程序的 Windows Installer 文件是否存在，请使用自定义脚本，或者选择 **始终假设安装应用程序** 来评估法规遵从性而不考虑是否安装了该应用程序的配置项目。  
  
 使用这些过程来配置中的检测方法 [!INCLUDE[cm5short](../LocTest/includes/cm5short_md.md)]。  
  
#### 若要通过使用 Windows Installer 文件中检测应用程序安装  
  
1.  在上 **检测方法** 页 **创建配置项目向导**, ，选择 **使用 Windows Installer 检测** 复选框。  
  
2.  单击 **打开**, ，浏览到你想要检测，然后单击 Windows Installer (.msi) 文件 **打开**。  
  
3.  **版本** 框中将自动填充所选的 Windows Installer 文件的版本号。 如果显示的值不正确的情况下，可以在此框中输入新的版本号。  
  
4.  如果要检测计算机上的每个用户配置文件，请选中“此应用程序是针对一个或多个用户安装的”  复选框。  
  
#### 若要检测特定应用程序和部署类型  
  
1.  在“创建配置项目向导”  的“检测方法” 页上，选中“检测特定的应用程序和部署类型”  复选框，然后单击“选择” 。  
  
2.  在“指定应用程序”  对话框中，选择要检测的应用程序和关联部署类型。  
  
#### 若要使用自定义脚本检测应用程序安装  
  
1.  在上 **检测方法** 页 **创建配置项目向导**, ，选择 **使用自定义脚本检测此应用程序** 复选框。  
  
2.  在列表中，选择想要打开的脚本语言。 从下面的脚本进行选择：  
  
    -   **VBScript**  
  
    -   **JScript**  
  
    -   **PowerShell**  
  
3.  单击“打开” ，浏览到要使用的脚本，然后单击“打开” 。  
  
##  <a name="BKMK_Step4"></a> 配置设置  
 使用此过程可在配置项目中配置设置。  
  
 设置表示业务或技术用于评估客户端设备上的符合性的条件。 你可以配置一个新的设置或浏览到引用计算机上的现有设置。  
  
#### 若要创建的设置  
  
1.  在上 **设置** 页 **创建配置项目向导**, ，单击 **新建**。  
  
2.  在上 **常规** 选项卡上 **创建设置** 对话框框中，提供以下信息：  
  
    -   **名称：** 输入设置的唯一名称。 最多可以使用 256 个字符。  
  
    -   **描述:** 输入设置的说明。 最多可以使用 256 个字符。  
  
    -   **设置类型：**在列表中，选择和配置要用于此设置的以下设置类型之一：  
  
        -   **Active Directory 查询**  
  
             **LDAP 前缀** - 指定 Active Directory 域服务查询的有效前缀以评估客户端计算机上的符合性。 您可以使用 **LDAP: / /** 为或 **GC: / /** 执行全局编录搜索...  
  
             **可分辨名称 (DN)** -指定客户端计算机上的符合性评估的 Active Directory 域服务对象的可分辨的名称。  
  
             例如，如果要评估与 corp.contoso.com 域中名为 John Smith 的用户相关的值，请输入以下内容：  
  
            -   **搜索筛选器** - 指定可选的 LDAP 筛选器以优化 Active Directory 域服务查询的结果，从而评估客户端计算机上的符合性。  
  
                 要从查询返回所有结果，请输入 **(objectclass=\*)**。  
  
            -   **搜索作用域** - 指定 Active Directory 域服务中的搜索作用域/可以从以下选项进行选择：  
  
                -   **基本** -查询只指定的对象。  
  
                -   **一级** - 此版本的 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)]中不使用此选项。  
  
                -   **子树** -查询指定的对象及其整个子树的目录中。  
  
            -   **属性** -指定用于评估客户端计算机上的符合性的 Active Directory 域服务对象的属性。  
  
                 例如，如果您想要查询 Active Directory 属性 **badPwdCount**, 、 存储的用户不正确地输入密码的次数、 输入 **badPwdCount** 此字段中。  
  
            -   **查询** -显示的查询中的条目构建的 **LDAP 前缀**, ， **可分辨的名称 (DN)**, ， **搜索筛选器** （如果指定），和 **属性**, ，它用于评估客户端计算机上的符合性。  
  
             有关构造 LDAP 查询的详细信息，请参阅 Windows Server 文档。  
  
        -   **程序集**  
  
             配置此设置类型的以下项：  
  
            -   **程序集名称：** 指定您想要搜索的程序集对象的名称。 该名称不能与同类型的其他程序集对象相同，并且必须在全局程序集缓存中注册。 程序集名称最多可以含有 256 个字符。  
  
             程序集是可在应用程序之间共享的一段代码。 程序集可以具有 .dll 或 .exe 文件扩展名。 全局程序集缓存是一个名为文件夹 *%systemroot%\Assembly* 在客户端上存储所有共享程序集的位置的计算机。  
  
        -   **文件系统**  
  
            -   **类型** – 从列表中，选择要搜索“文件”  还是“文件夹” 。  
  
            -   **路径** -指定客户端计算机上的指定的文件或文件夹的路径。 你可以在路径中指定系统环境变量和 *%USERPROFILE%* 环境变量。  
  
                > [!NOTE]  
                >  如果在“路径”  或“文件或文件夹名称”  框中使用 **%USERPROFILE%** 环境变量，则将搜索客户端计算机上的所有用户配置文件，这会导致找到该文件或文件夹的多个实例。  
                >   
                >  如果符合性设置无权访问指定路径，则会生成发现错误。 此外，如果您要搜索的文件当前正在使用，则生成发现错误。  
  
            -   **文件或文件夹名称** -指定要搜索的文件或文件夹对象的名称。 你可以在文件或文件夹名称中指定系统环境变量和 *%USERPROFILE%* 环境变量。 还可以在文件名中 使用通配符 * 和 ?。  
  
                > [!NOTE]  
                >  如果指定文件或文件夹名称并使用通配符，则此组合可能会产生大量结果，并可能会在向 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)]报告结果时导致客户端计算机上的较高资源使用率和较高网络流量。  
  
            -   **包括子文件夹** – 如果也要搜索指定路径下面的任何子文件夹，请启用此选项。  
  
            -   **此文件或文件夹是与 64 位应用程序相关联** -如果启用，仅限 64 位文件位置 (如 *%programfiles%*) 将进行检查，在 64 位计算机上。 如果未启用此选项，则会检查 32 位（如 *%ProgramFiles(x86)%*）和 64 位位置。  
  
                > [!NOTE]  
                >  如果在同一 64 位计算机上的 64 位和 32 位系统文件位置中存在相同的文件或文件夹，则全局条件会发现多个文件。  
  
             “文件系统”  设置类型不支持在“路径”  框中指定网络共享的 UNC 路径。  
  
        -   **IIS 元数据库**  
  
            -   **元数据库路径** - 指定 Internet Information Services (IIS) 元数据库的有效路径。  
  
            -   **属性 ID** - 指定 IIS 元数据库设置的数值属性。  
  
        -   **注册表项**  
  
            -   **配置单元** – 在列表中，选择要在其中进行搜索的注册表配置单元。  
  
            -   **项** - 指定要搜索的注册表项名称。 使用格式 *注册表*。  
  
            -   **此注册表项是否与 64 位应用程序相关联** -指定是否应在正在运行 Windows 的 64 位版本的客户端上的 32 位注册表项除了搜索 64 位注册表项。  
  
                > [!NOTE]  
                >  如果在同一 64 位计算机上的 64 位和 32 位注册表位置中存在相同的注册表项，则全局条件会发现两个注册表项。  
  
        -   **注册表值**  
  
            -   **配置单元** - 在列表中，选择要在其中进行搜索的注册表配置单元。  
  
            -   **项** - 指定要搜索的注册表项名称。 使用格式 *注册表*。  
  
            -   **值** – 指定必须包含在指定注册表项中的值。  
  
            -   **此注册表项与 64 位应用程序关联** - 指定在运行 64 位版本的 Windows 的客户端上除了搜索 32 位注册表项之外是否也应该搜索 64 位注册表项。  
  
                > [!NOTE]  
                >  如果在同一 64 位计算机上的 64 位和 32 位注册表位置中存在相同的注册表项，则全局条件会发现两个注册表项。  
  
             还可以单击“浏览”  以浏览到计算机或远程计算机上的注册表位置。 若要浏览远程计算机，必须具有管理员权限的远程计算机上和远程计算机必须运行远程注册表服务。  
  
        -   **脚本**  
  
            -   **发现脚本** – 单击“添加”  以进行输入，或浏览到要使用的脚本。 您可以使用 Windows PowerShell、 VBScript、 或 Microsoft JScript 脚本。  
  
            -   **使用登录用户凭据运行脚本** – 如果启用此选项，则脚本会在使用登录用户凭据的客户端计算机上。  
  
                > [!NOTE]  
                >  脚本返回的值用于评估全局条件的符合性。 例如，使用 VBScript 时，可以使用命令“WScript.Echo Result”  将 *Result* 变量值返回给全局条件。  
  
        -   **SQL 查询**  
  
            -   **SQL Server 实例** – 选择是要在默认实例、所有实例还是指定的数据库实例名称上运行 SQL 查询。  
  
                > [!NOTE]  
                >  实例名称必须引用 SQL Server 的本地实例。 为了引用群集的 SQL Server 实例，应该使用脚本设置。  
  
            -   **数据库** -指定要对其运行的 SQL 查询的 Microsoft SQL Server 数据库的名称。  
  
            -   **列** -指定将用于评估全局条件的符合性的 TRANSACT-SQL 语句返回的列名称。  
  
            -   **TRANSACT-SQL 语句** – 指定您想要用于全局条件的完整 SQL 查询。 也可以单击“打开”  以打开现有的 SQL 查询。  
  
                > [!IMPORTANT]  
                >  SQL 查询设置不支持任何修改数据库的 SQL 命令。 只能使用从数据库读取信息的 SQL 命令。  
  
        -   **WQL 查询**  
  
            -   **命名空间** -指定 Windows Management Instrumentation (WMI) 命名空间用来构建针对客户端计算机上的符合性评估的 WQL 查询。 默认值为 Root\cimv2。  
  
            -   **类** -指定用于构建针对客户端计算机上的符合性评估的 WQL 查询的 WMI 类。  
  
            -   **属性** -指定用于构建针对客户端计算机上的符合性评估的 WQL 查询的 WMI 属性。  
  
            -   **WQL 查询 WHERE 子句** -您可以使用 **WQL 查询 WHERE 子句** 项目来指定 WHERE 子句应用于指定的命名空间、 类和客户端计算机上的属性。  
  
        -   **XPath 查询**  
  
            -   **路径** - 指定客户端计算机上用于评估符合性的 .xml 文件的路径。 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 支持使用所有 Windows 系统环境变量和 *%USERPROFILE%* 的路径名称中的用户变量。  
  
            -   **XML 文件名** -指定包含用于评估客户端计算机上的符合性的 XML 查询的文件的名称。  
  
            -   **包括子文件夹** – 如果也要搜索指定路径下面的任何子文件夹，请启用此选项。  
  
            -   **此文件与 64 位应用程序关联时** -选择是否 64 位系统文件位置 (*%windir%*\System32) 应搜索除了 32 位系统文件位置 (*%windir%*\Syswow64) 上 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 运行 Windows 的 64 位版本的客户端。  
  
            -   **XPath 查询** -指定的有效完整 XML 路径语言 (XPath) 查询用于评估客户端计算机上的符合性。  
  
            -   **命名空间** - 打开“XML 命名空间”  对话框以标识要在 XPath 查询期间使用的命名空间和前缀。  
  
             如果尝试发现加密的 .xml 文件，则符合性设置会查找该文件，但 XPath 查询不生成任何结果，并且不生成任何错误。  
  
             如果 XPath 查询无效，则设置在客户端计算机上会评估为不符合。  
  
    -   **数据类型：** 在列表中，选择在用于评估设置之前条件用于返回数据的格式。 **数据类型** 列表不显示所有设置类型。  
  
        > [!NOTE]  
        >  **浮点数** 小数点后的数据类型支持只需 3 位数字。  
  
3.  配置此设置下的更多详情 **设置类型** 列表。 您可以配置的项已选择的设置类型而异。  
  
    > [!NOTE]  
    >  当您创建的类型设置 **文件系统**, ， **注册表项**, ，和 **注册表值**, ，您可以单击 **浏览** 在引用计算机上配置基于值的设置。 若要浏览到注册表项或远程计算机上的值，远程计算机必须具有启用远程注册表服务。  
  
4.  单击“确定”  以保存设置并关闭“创建设置”  对话框。  
  
##  <a name="BKMK_Step5"></a> 配置符合性规则  
 使用以下过程可为配置项目配置符合性规则。  
  
 符合性规则指定定义配置项目的符合性的条件。 设置可以评估的符合性之前，它必须具有至少一个符合性规则。 WMI、 注册表和脚本设置可以修正找到要不符合要求的值。 您可以创建新的规则或浏览到要在其中选择规则任何配置项目中的现有设置。  
  
#### 若要创建符合性规则  
  
1.  在上 **法规遵从性规则** 页 **创建配置项目向导**, ，单击 **新建**。  
  
2.  在 **Create Rule** 对话框框中，提供以下信息：  
  
    -   **名称：** 输入符合性规则的名称。  
  
    -   **描述:** 输入符合性规则的说明。  
  
    -   **选定的设置：** 单击 **浏览** 若要打开 **选择设置** 对话框。 选择您想要定义的规则，或单击设置 **新设置**。 在完成，请单击 **选择**。  
  
        > [!NOTE]  
        >  您也可以单击 **属性** 若要查看有关当前所选设置的信息。  
  
    -   **规则类型：** 选择您想要使用的符合性规则的类型：  
  
        -   **值** 创建配置项与您指定的值返回的值进行比较的规则。  
  
        -   **Existential** 创建计算结果具体取决于它是否存在或找到了该次数客户端设备上设置的规则。  
  
    -   为规则类型的 **值**, ，指定以下信息：  
  
        -   **设置必须符合以下规则** – 选择一个运算符和一个值，与所选设置的符合性评估。 可以使用以下运算符：  
  
            |运算符|更多信息|  
            |--------------|----------------------|  
            |等于|无更多信息|  
            |不等于|无更多信息|  
            |大于|无更多信息|  
            |小于|无更多信息|  
            |之间|无更多信息|  
            |大于或等于|无更多信息|  
            |小于或等于|无更多信息|  
            |其中一个|在文本框中，在每个行中指定一个条目。|  
            |无|在文本框中，在每个行中指定一个条目。|  
  
        -   **修正非符合性规则支持时** – 如果您希望选择此选项 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 以自动修正非符合性规则。 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 可以自动修正以下的规则类型：  
  
            -   **注册表值** – 时不符合要求，进行修正的注册表值并创建如果不存在。  
  
            -   **脚本** (通过自动运行修正脚本)。  
  
            -   **WQL 查询**  
  
            > [!IMPORTANT]  
            >  当规则运算符设置为只能修正非符合性规则 **等于**。  
  
        -   **如果找不到此设置实例报告不符合性** – 配置项目报告不符合性如果客户端计算机上找不到此设置。  
  
        -   **报表的不符合性严重性：** 指定如果此符合性规则失败报告的严重性级别。 可用的严重性级别如下所示：  
  
            -   **None** 不符合此符合性规则的计算机不报告故障严重性为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。  
  
            -   **信息** 不符合此符合性规则的计算机报告故障严重性 **信息** 为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。  
  
            -   **警告** 不符合此符合性规则的计算机报告故障严重性 **警告** 为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。  
  
            -   **严重** 不符合此符合性规则的计算机报告故障严重性 **严重** 为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。  
  
            -   **与事件的严重** 不符合此符合性规则的计算机报告故障严重性 **严重** 为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。 此外会记录此严重性级别为应用程序事件日志中的 Windows 事件。  
  
        -   为规则类型的 **Existential**, ，指定以下信息：  
  
            > [!NOTE]  
            >  显示的选项可能要配置的规则设置类型而异。  
  
            -   **客户端设备上必须存在设置**  
  
            -   **设置不得存在于客户端设备**  
  
            -   **该设置会发生以下次数:**  
  
        -   **报表的不符合性严重性：** 指定如果此符合性规则失败报告的严重性级别。 可用的严重性级别如下所示：  
  
            -   **None** 不符合此符合性规则的计算机不报告故障严重性为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。  
  
            -   **信息** 不符合此符合性规则的计算机报告故障严重性 **信息** 为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。  
  
            -   **警告** 不符合此符合性规则的计算机报告故障严重性 **警告** 为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。  
  
            -   **严重** 不符合此符合性规则的计算机报告故障严重性 **严重** 为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。  
  
            -   **与事件的严重** 不符合此符合性规则的计算机报告故障严重性 **严重** 为 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 报表。 应用程序事件日志中也会以 Windows 事件的形式记录此严重性级别。  
  
3.  单击“确定”  关闭“创建规则”  对话框。  
  
##  <a name="BKMK_Step6"></a> 指定支持的平台  
 支持的平台是在其上对配置项目评估符合性的操作系统。  
  
#### 为配置项目指定支持的平台  
  
1.  在“创建配置项目向导”  的“支持的平台” 页上，在列表中选择要在其上对配置项目评估符合性的 Windows 版本，或单击“全选” 。  
  
## 完成向导  
 在向导的“摘要”  页上，查看将执行的操作，然后完成向导。 新的配置项目显示在 **配置项目** 中的节点 **资产和符合性** 工作区。  
  
## 另请参阅  
 [为使用 System Center Configuration Manager 客户端管理的设备配置项目](../LocTest/Configuration-items-for-devices-managed-with-the-System-Center-Configuration-Manager-client.md)