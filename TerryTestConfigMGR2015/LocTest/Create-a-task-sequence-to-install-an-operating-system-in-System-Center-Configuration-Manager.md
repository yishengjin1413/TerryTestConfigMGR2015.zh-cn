---
title: "在 System Center Configuration Manager 中创建用于安装操作系统的任务序列"
ms.custom: na
ms.date: 09/02/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: 
  - configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
applies_to: 
  - System Center Configuration Manager (current branch)
ms.assetid: 217c8a0e-5112-420e-a325-2a6d75326290
caps.latest.revision: 13
caps.handback.revision: 12
translationtype: Human Translation
---
# 在 System Center Configuration Manager 中创建用于安装操作系统的任务序列
在 [!INCLUDE[cm6long](../LocTest/includes/cm6long_md.md)] 中使用任务序列在目标计算机上自动安装操作系统映像。 创建一个任务序列，该任务序列引用用于启动目标计算机的启动映像、要安装在目标计算机上的操作系统映像以及要安装的任何其他附加内容（例如其他应用程序或软件更新）。 然后将任务序列部署到包含目标计算机的集合。  
  
##  <a name="BKMK_InstallOS"></a> 创建用于安装操作系统的任务序列  
 有大量方案可用于将操作系统部署到环境中的计算机。 在大多数情况下，将创建任务序列并在“创建任务序列向导”中选择 **安装现有映像包** 来安装操作系统、迁移用户设置、应用软件更新和安装应用程序。 在创建任务序列以安装操作系统之前，以下方面必须已到位：  
  
-   **必需**  
  
     [启动映像](http://technet.microsoft.com/library/mt627946\(TechNet.10\).aspx) 和  [操作系统映像](https://technet.microsoft.com/library/mt627939\(TechNet.10\).aspx) 在 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 控制台中必须可用。  
  
-   **必需（若使用）\)**  
  
     在[控制台中，](https://technet.microsoft.com/library/mt612804\(TechNet.10\).aspx) 软件更新 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 必须同步。  
  
     [应用程序](https://technet.microsoft.com/library/mt595707\(TechNet.10\).aspx) 必须添加到 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 控制台。  
  
#### 若要创建用于安装操作系统的任务序列  
  
1.  在 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 控制台中，单击“软件库” 。  
  
2.  在“软件库”  工作区中，展开“操作系统” ，然后单击“任务序列” 。  
  
3.  在“主页”  选项卡上的“创建”  组中，单击“创建任务序列”  以启动创建任务序列向导。  
  
4.  在“创建新的任务序列”  页上，单击“安装现有的映像包” ，然后单击“下一步” 。  
  
5.  在“任务序列信息”  页上，指定以下设置，然后单击“下一步” 。  
  
    -   **任务序列名称**：指定用于标识任务序列的名称。  
  
    -   **描述**：指定任务序列所执行的任务的描述。  
  
    -   **启动映像包**：指定用于在目标计算机上安装操作系统的启动映像。 启动映像包含用于安装操作系统的 Windows PE 的某个版本，以及任何其他所需的设备驱动程序。 有关信息，请参阅[使用 System Center Configuration Manager 管理启动映像](../LocTest/Manage-boot-images-with-System-Center-Configuration-Manager.md)。  
  
        > [!IMPORTANT]  
        >  启动映像的体系结构必须与目标计算机的硬件体系结构兼容。  
  
6.  在“安装 Windows”  页上，指定以下设置，然后单击“下一步” 。  
  
    -   **映像包**：指定包含要安装的操作系统映像的包。 有关详细信息，请参阅[使用 System Center Configuration Manager 管理操作系统映像](../LocTest/Manage-operating-system-images-with-System-Center-Configuration-Manager.md)。  
  
    -   **映像**：如果操作系统映像包有多个映像，请指定要安装的操作系统映像的索引。  
  
    -   **对安装操作系统的目标计算机进行分区和格式化**：指定是否希望任务序列在安装操作系统之前对目标计算机进行分区和格式化。  
  
    -   **产品密钥**：指定要安装的 Windows 操作系统的产品密钥。 你可以指定编码的批量许可证密钥和标准产品密钥。 如果使用非编码的产品密钥，则必须通过短破折号 \(\-\) 将每 5 个字符分隔为一组。 例如：*XXXXX\-XXXXX\-XXXXX\-XXXXX\-XXXXX*  
  
    -   **服务器授权模式**：指定服务器许可证为“每客户” 、“每服务器” 或未指定许可证。 如果服务器许可证为“每服务器” ，则还需指定服务器连接的最大数量。  
  
    -   指定如何处理在部署操作系统映像时使用的管理员帐户。  
  
        -   **禁用本地管理员帐户**：指定在部署操作系统映像时是否禁用本地管理员帐户。  
  
        -   **始终使用同一管理员密码**：指定是否为部署操作系统映像的所有计算机上的本地管理员帐户使用同一密码。  
  
7.  在“配置网络”  页上，指定以下设置，然后单击“下一步” 。  
  
    -   **加入工作组**：指定是否将目标计算机添加到工作组。  
  
    -   **加入域**：指定是否将目标计算机添加到域。 在“域” 中，指定域的名称。  
  
        > [!IMPORTANT]  
        >  你可以浏览以查找本地林中的域，但对于远程林则必须指定域名。  
  
         你还可以指定组织单位 \(OU\)。 这是一项可选设置，用于指定在其中创建计算机帐户的 OU 的 LDAP X.500 可分辨名称（如果尚未存在）。  
  
    -   **帐户**：指定具有加入指定域的权限的帐户的用户名和密码。 例如：*domain\\user* 或 *%variable%*。  
  
        > [!IMPORTANT]  
        >  如果打算迁移域设置或工作组设置，你必须输入适当的域凭据。  
  
8.  在“安装 Configuration Manager”  页上，指定要安装到目标计算机上的 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 客户端包，然后单击“下一步” 。  
  
9. 在“状态迁移”  页上，指定以下信息，然后单击“下一步” 。  
  
    -   **捕获用户设置**：指定任务序列是否捕获用户状态。 有关如何捕获和还原用户状态的详细信息，请参阅[在 System Center Configuration Manager 中管理用户状态](../LocTest/Manage-user-state-in-System-Center-Configuration-Manager.md)。  
  
    -   **捕获网络设置**：指定任务序列是否从目标计算机中捕获网络设置。 除了捕获网络适配器设置外，你还可以捕获域或工作组的成员身份。  
  
    -   **捕获 Microsoft Windows 设置**：指定任务序列是否在安装操作系统映像之前从目标计算机中捕获 Windows 设置。 你可以捕获计算机名、注册的用户和组织名称以及时区设置。  
  
10. 在“包括更新”  页上，指定是安装必需的软件更新、所有软件更新还是不安装软件更新，然后单击“下一步” 。 如果指定要安装软件更新， [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 将只会安装以包含目标计算机的集合为目标的那些软件更新。  
  
11. 在“安装应用程序”  页上，指定要安装在目标计算机上的应用程序，然后单击“下一步” 。 如果指定多个应用程序，你也可以指定任务序列在特定应用程序的安装失败时继续进行。  
  
12. 完成向导。  
  
 你现在可以将任务序列部署到计算机集合。  有关详细信息，请参阅 [Deploy a task sequence](../LocTest/Manage-task-sequences-to-automate-tasks-in-System-Center-Configuration-Manager.md#BKMK_DeployTS)。  
  
##  <a name="BKMK_InstallExistingOSImageTSExample"></a> 安装现有操作系统映像的示例任务序列  
 使用下表作为您创建任务序列以部署使用现有操作系统映像的操作系统时的指导。 该表将帮助您决定任务序列步骤的常规顺序，以及如何将这些任务序列步骤组织并构建成逻辑组。 您创建的任务序列可能与此示例有所不同并可包含更多或更少的任务序列步骤和组。  
  
> [!IMPORTANT]  
>  必须始终使用创建任务序列向导来创建此任务序列。  
  
 当您使用创建任务序列向导创建此新任务序列的任务序列步骤名称一些是不同于什么比它们是什么如果已将这些任务序列步骤手动添加到现有任务序列。 下表显示了命名差异：  
  
|创建任务序列向导任务序列步骤名称|相当的任务序列编辑器步骤名称|  
|---------------------------------------------------------|-----------------------------------------------|  
|请求用户状态存储|请求状态存储|  
|捕获用户文件和设置|捕获用户状态|  
|发布用户状态存储|发布状态存储|  
|在 Windows PE 中重新启动|重新启动到 Windows PE 或硬盘|  
|对磁盘 0 分区|格式化磁盘并分区|  
|还原用户文件和设置|还原用户状态|  
  
|任务序列组或步骤|描述|  
|---------------------------------|-----------------|  
|捕获文件和设置 \-**（新建任务序列组）**|创建任务序列组。 任务序列组将保留在一起以更好地组织和错误控制类似的任务序列步骤。<br /><br /> 此组包含从引用计算机操作系统捕获文件和设置所需的步骤。|  
|捕获 Windows 设置|使用此任务序列步骤来标识要从引用计算机捕获的 Microsoft Windows 设置。 您可以捕获计算机名称、用户和组织信息以及时区设置。|  
|捕获网络设置|使用此任务序列步骤来从引用计算机捕获网络设置。 您可以捕获引用计算机和网络适配器设置信息的域或工作组成员身份。|  
|捕获用户文件和设置 \-**（新建任务序列子组）**|创建任务序列组内的一个任务序列组。 此子组包含捕获用户状态数据所需的步骤。 类似于你添加的初始组，此子组将类似的任务序列步骤放在一起，以获得更佳的组织和错误控制。|  
|请求用户状态存储|使用此任务序列步骤来请求访问状态迁移点存储用户状态数据的位置。 您可以将此任务序列步骤配置为捕获或还原用户状态信息。|  
|捕获用户文件和设置|使用此任务序列步骤以使用用户状态迁移工具 \(USMT\) 从将接收与此任务步骤关联的任务序列的引用计算机捕获用户状态和设置。 您可以捕获标准选项或通过配置名选项来捕获。|  
|发布用户状态存储|使用此任务序列步骤通知状态迁移点捕获或还原操作完毕。|  
|安装操作系统 \-**（新建任务序列组）**|创建另一个任务序列子组。 此子组包含安装和配置 Windows PE 环境所需的步骤。|  
|在 Windows PE 中重新启动|使用此任务序列步骤来指定接收此任务序列的目标计算机的重新启动选项。 此步骤中将显示一条消息指向指示计算机将重新启动，以便才能继续安装的用户。<br /><br /> 此步骤使用只读 **\_SMSTSInWinPE** 任务序列变量。 如果相关联的值等于 **false** 任务序列步骤将继续。|  
|对磁盘 0 分区|此任务序列步骤指定目标计算机上的硬盘进行格式化所需的操作。 默认磁盘编号为 **0**。<br /><br /> 此步骤使用只读 **\_SMSTSClientCache** 任务序列变量。 如果 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 客户端缓存不存在，则此步骤将会运行。|  
|应用操作系统|使用此任务序列步骤安装到目标计算机上的操作系统映像。 此步骤首先删除目标计算机上对应顺序磁盘卷上的所有文件（[!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)]\- 特定控制文件除外），然后将 WIM 文件中包含的所有卷映像应用到该顺序磁盘卷。 您可以指定 **sysprep** 答案文件，还将配置的磁盘分区用于安装。|  
|应用 Windows 设置|使用此任务序列步骤配置目标计算机的 Windows 设置配置信息。 可应用的 Windows 设置包括用户和组织信息、产品或许可密钥信息、时区，以及本地管理员密码。|  
|应用网络设置|使用此任务序列步骤来指定为目标计算机的网络或工作组配置信息。 此外可以指定计算机使用 DHCP 服务器是否可以静态地分配的 IP 地址信息。|  
|应用设备驱动程序|使用此任务序列步骤作为操作系统部署的一部分安装驱动程序。 您可以允许 Windows 安装程序通过选择搜索所有现有的驱动程序类别 **考虑所有类别的驱动程序** 或通过选择哪些驱动程序类别 Windows 安装程序将搜索的限制 **限制为仅考虑所选类别的驱动程序的驱动程序匹配**。<br /><br /> 此步骤使用只读 **\_SMSTSMediaType** 任务序列变量。 此任务序列步骤仅当运行该变量的值不等于 **FullMedia**。|  
|应用驱动程序包|使用此任务序列步骤以使驱动程序包中所有设备驱动程序可用于使用 Windows 安装程序。|  
|设置操作系统 \-**（新建任务序列组）**|创建另一个任务序列子组。 此子组包含设置已安装操作系统所需的步骤。|  
|安装 Windows 和 ConfigMgr|使用此任务序列步骤来安装 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 客户端软件。 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 安装并注册 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)] 客户端 GUID。 您可以分配中的必要的安装参数 **安装属性** 窗口。|  
|安装更新|使用此任务序列步骤来指定如何在目标计算机上安装软件更新。 在运行此任务序列步骤时，才会评估目标计算机是否有适用的软件更新。 那时，会与其他 [!INCLUDE[cmshort](../LocTest/includes/cmshort_md.md)]\- 托管客户端一样评估目标计算机是否有合适的软件更新。<br /><br /> 此步骤使用只读 **\_SMSTSMediaType** 任务序列变量。 此任务序列步骤仅当运行该变量的值不等于 **FullMedia**。|  
|还原用户文件和设置 \-**（新建任务序列子组）**|创建另一个任务序列子组。 此子组包含还原用户文件和设置所需的步骤。|  
|请求用户状态存储|使用此任务序列步骤来请求访问状态迁移点存储用户状态数据的位置。|  
|还原用户文件和设置|使用此任务序列步骤来启动用户状态迁移工具 \(USMT\) 将用户状态和设置还原到目标计算机。|  
|发布用户状态存储|使用此任务序列步骤通知状态迁移点不再需要用户状态数据。|  
  
## 另请参阅  
 [管理任务序列以在 System Center Configuration Manager 中自动执行任务](../LocTest/Manage-task-sequences-to-automate-tasks-in-System-Center-Configuration-Manager.md)